# -*- coding: utf-8 -*-# Define your item pipelines here## Don't forget to add your pipeline to the ITEM_PIPELINES setting# See: http://doc.scrapy.org/en/latest/topics/item-pipeline.htmlfrom scrapy.exceptions import DropItemfrom Home_Link.db.house import Housefrom Home_Link.db.config import DBSessionclass NoIdPipeline(object):    def process_item(self, item, spider):        if item.get('hid', 'not set') == 'not set':            raise DropItem('Missing id in %s' % item)        else:            return itemclass DuplicateIdPipeline(object):    def open_spider(self, spider):        self.session = DBSession()    def process_item(self, item, spider):        if self.session.query(House).filter(House.hid == item.get('hid')).count() > 0:            raise DropItem('Duplicated id')        else:            return item    def close_spider(self, spider):        self.session.close()class DataBasePipeline(object):    def open_spider(self, spider):        self.session = DBSession()    def process_item(self, item, spider):        h = House(            hid=item.get('hid'),            url=item.get('url'),            title=item.get('title'),            price=item.get('price'),            room=item.get('room'),            htype=item.get('htype'),            area=item.get('area'),            areaName=item.get('areaName')        )        self.session.add(h)        self.session.commit()    def close_spider(self, spider):        self.session.close()